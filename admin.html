<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SRT Challenge Admin</title>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
<script src="firebase-config.js"></script>
<style>
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'Noto Sans KR', -apple-system, BlinkMacSystemFont, sans-serif;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    min-height: 100vh;
    padding: 20px;
}

.container {
    max-width: 600px;
    margin: 0 auto;
}

/* í—¤ë” */
.header {
    text-align: center;
    color: white;
    margin-bottom: 25px;
}

.header h1 {
    font-size: 24px;
    font-weight: 700;
    margin-bottom: 5px;
}

.header p {
    font-size: 14px;
    opacity: 0.9;
}

/* ì¹´ë“œ ìŠ¤íƒ€ì¼ */
.card {
    background: white;
    border-radius: 16px;
    padding: 20px;
    margin-bottom: 20px;
    box-shadow: 0 10px 40px rgba(0,0,0,0.15);
}

.card-title {
    font-size: 16px;
    font-weight: 700;
    color: #333;
    margin-bottom: 15px;
    display: flex;
    align-items: center;
    gap: 8px;
}

.card-title .icon {
    font-size: 20px;
}

/* ìƒíƒœ ë³€ê²½ í¼ */
.form-group {
    margin-bottom: 15px;
}

.form-group label {
    display: block;
    font-size: 13px;
    color: #666;
    margin-bottom: 6px;
    font-weight: 500;
}

.form-group select {
    width: 100%;
    padding: 12px 15px;
    border: 2px solid #e0e0e0;
    border-radius: 10px;
    font-size: 14px;
    color: #333;
    background: white;
    cursor: pointer;
    transition: border-color 0.2s;
}

.form-group select:focus {
    outline: none;
    border-color: #667eea;
}

.btn-primary {
    width: 100%;
    padding: 14px;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    border: none;
    border-radius: 10px;
    font-size: 15px;
    font-weight: 600;
    cursor: pointer;
    transition: transform 0.2s, box-shadow 0.2s;
}

.btn-primary:hover {
    transform: translateY(-2px);
    box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
}

.btn-primary:active {
    transform: translateY(0);
}

/* ì•Œë¦¼ ë©”ì‹œì§€ */
.alert {
    padding: 12px 15px;
    border-radius: 10px;
    margin-top: 15px;
    font-size: 14px;
    display: none;
}

.alert.success {
    background: #e8f5e9;
    color: #2e7d32;
    border: 1px solid #a5d6a7;
    display: block;
}

/* ì°¸ê°€ì ëª©ë¡ */
.participant-list {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 10px;
}

.participant-item {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 12px 15px;
    background: #f8f9fa;
    border-radius: 10px;
    transition: background 0.2s;
}

.participant-item:hover {
    background: #f0f0f0;
}

.participant-info {
    display: flex;
    align-items: center;
    gap: 10px;
}

.participant-num {
    width: 28px;
    height: 28px;
    background: #667eea;
    color: white;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 12px;
    font-weight: 600;
}

.participant-name {
    font-size: 14px;
    font-weight: 500;
    color: #333;
}

.status-badge {
    padding: 4px 10px;
    border-radius: 20px;
    font-size: 11px;
    font-weight: 600;
}

.status-badge.normal {
    background: #e3f2fd;
    color: #1976d2;
}

.status-badge.rest {
    background: #fff3e0;
    color: #f57c00;
}

/* í†µê³„ */
.stats {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 10px;
    margin-bottom: 15px;
}

.stat-item {
    text-align: center;
    padding: 15px 10px;
    background: #f8f9fa;
    border-radius: 10px;
}

.stat-number {
    font-size: 24px;
    font-weight: 700;
    color: #667eea;
}

.stat-label {
    font-size: 11px;
    color: #888;
    margin-top: 3px;
}

/* í™ˆìœ¼ë¡œ ëŒì•„ê°€ê¸° */
.back-link {
    display: block;
    text-align: center;
    color: white;
    text-decoration: none;
    font-size: 14px;
    opacity: 0.9;
    margin-top: 10px;
}

.back-link:hover {
    opacity: 1;
    text-decoration: underline;
}
</style>
</head>
<body>

<div class="container">
    <div class="header">
        <h1>âš™ï¸ SRT Challenge ê´€ë¦¬ì</h1>
        <p>ì°¸ê°€ì ìƒíƒœë¥¼ ê´€ë¦¬í•©ë‹ˆë‹¤</p>
    </div>

    <!-- í†µê³„ ì¹´ë“œ -->
    <div class="card">
        <div class="card-title"><span class="icon">ğŸ“Š</span> í˜„í™©</div>
        <div class="stats">
            <div class="stat-item">
                <div class="stat-number" id="totalCount">24</div>
                <div class="stat-label">ì „ì²´</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="normalCount">0</div>
                <div class="stat-label">í™œë™ì¤‘</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="restCount">0</div>
                <div class="stat-label">íœ´ì‹ì¤‘</div>
            </div>
        </div>
    </div>

    <!-- ìƒíƒœ ë³€ê²½ ì¹´ë“œ -->
    <div class="card">
        <div class="card-title"><span class="icon">ğŸ‘¤</span> íšŒì› ìƒíƒœ ë³€ê²½</div>
        
        <div class="form-group">
            <label>ì°¸ê°€ì ì„ íƒ</label>
            <select id="pSelect">
                <option value="">-- ì°¸ê°€ìë¥¼ ì„ íƒí•˜ì„¸ìš” --</option>
            </select>
        </div>
        
        <div class="form-group">
            <label>ìƒíƒœ ì„ íƒ</label>
            <select id="statusSelect">
                <option value="normal">ì •ìƒ (í™œë™ì¤‘)</option>
                <option value="rest">íœ´ì‹</option>
            </select>
        </div>
        
        <button class="btn-primary" onclick="updateStatus()">ìƒíƒœ ë³€ê²½í•˜ê¸°</button>
        
        <div class="alert" id="statusMsg"></div>
    </div>

    <!-- ì°¸ê°€ì ëª©ë¡ ì¹´ë“œ -->
    <div class="card">
        <div class="card-title"><span class="icon">ğŸ‘¥</span> ì°¸ê°€ì ëª©ë¡</div>
        <div class="participant-list" id="participantList"></div>
    </div>

    <a href="index.html" class="back-link">â† ë©”ì¸ í™”ë©´ìœ¼ë¡œ ëŒì•„ê°€ê¸°</a>
</div>

<script>
// ê¸°ë³¸ ì°¸ê°€ì ë°ì´í„°
const defaultParticipants = {
    1: { name: 'ê¹€í˜•íƒœ', status: 'normal' },
    2: { name: 'ê¹€ë¯¸ì˜', status: 'normal' },
    3: { name: 'ê¹€í˜¸ì¢…', status: 'normal' },
    4: { name: 'ê¹€ìƒë‚¨', status: 'normal' },
    5: { name: 'ê¹€í˜„í¬', status: 'normal' },
    6: { name: 'ì´ë¯¸ìˆ™', status: 'normal' },
    7: { name: 'ì†Œë³‘ë“', status: 'normal' },
    8: { name: 'ë°•ì€ì •', status: 'normal' },
    9: { name: 'ê¹€ë§Œí™˜', status: 'normal' },
    10: { name: 'ìœ¤ì¢…ì„', status: 'normal' },
    11: { name: 'ë°•ì°½ì„ ', status: 'normal' },
    12: { name: 'ë°•ê²½í˜„', status: 'normal' },
    13: { name: 'ê¹€ìœ ì„±', status: 'normal' },
    14: { name: 'ì•ˆì§€í›ˆ', status: 'normal' },
    15: { name: 'ê¹€ë¯¼ì£¼', status: 'normal' },
    16: { name: 'ë°•ë¬´ì˜', status: 'normal' },
    17: { name: 'ê¹€ë³‘ê¸°', status: 'normal' },
    18: { name: 'ê¹€ì¬ì‚°', status: 'normal' },
    19: { name: 'ê°•ë™í˜„', status: 'normal' },
    20: { name: 'ì†ë¯¸ì—°', status: 'normal' },
    21: { name: 'ì´ê²½ë¯¼', status: 'normal' },
    22: { name: 'ê°•í˜„ì •', status: 'normal' },
    23: { name: 'ë°•ì§„í¬', status: 'normal' },
    24: { name: 'ì•ˆê¸¸ì„', status: 'normal' }
};

let participants = {};
let db;

// Firebase ì´ˆê¸°í™” í™•ì¸
function initFirebase() {
    if (typeof firebase !== 'undefined' && firebase.database) {
        db = firebase.database();
        loadParticipants();
    } else {
        // Firebase ì—†ìœ¼ë©´ ê¸°ë³¸ ë°ì´í„° ì‚¬ìš©
        participants = defaultParticipants;
        renderAll();
    }
}

// ì°¸ê°€ì ë°ì´í„° ë¡œë“œ
function loadParticipants() {
    db.ref("participants").on("value", snap => {
        const data = snap.val();
        if (data) {
            participants = data;
        } else {
            // ë°ì´í„°ê°€ ì—†ìœ¼ë©´ ê¸°ë³¸ê°’ìœ¼ë¡œ ì´ˆê¸°í™”
            participants = defaultParticipants;
            db.ref("participants").set(defaultParticipants);
        }
        renderAll();
    });
}

// ì „ì²´ ë Œë”ë§
function renderAll() {
    renderSelect();
    renderParticipantList();
    updateStats();
}

// ì…€ë ‰íŠ¸ ë°•ìŠ¤ ë Œë”ë§
function renderSelect() {
    const sel = document.getElementById("pSelect");
    sel.innerHTML = '<option value="">-- ì°¸ê°€ìë¥¼ ì„ íƒí•˜ì„¸ìš” --</option>';
    
    Object.keys(participants).sort((a, b) => Number(a) - Number(b)).forEach(id => {
        const p = participants[id];
        const statusText = p.status === 'rest' ? ' (íœ´ì‹ì¤‘)' : '';
        sel.innerHTML += `<option value="${id}">${id}. ${p.name}${statusText}</option>`;
    });
}

// ì°¸ê°€ì ëª©ë¡ ë Œë”ë§
function renderParticipantList() {
    const list = document.getElementById("participantList");
    list.innerHTML = '';
    
    Object.keys(participants).sort((a, b) => Number(a) - Number(b)).forEach(id => {
        const p = participants[id];
        const statusClass = p.status === 'rest' ? 'rest' : 'normal';
        const statusText = p.status === 'rest' ? 'íœ´ì‹' : 'í™œë™';
        
        list.innerHTML += `
            <div class="participant-item">
                <div class="participant-info">
                    <div class="participant-num">${id}</div>
                    <div class="participant-name">${p.name}</div>
                </div>
                <div class="status-badge ${statusClass}">${statusText}</div>
            </div>
        `;
    });
}

// í†µê³„ ì—…ë°ì´íŠ¸
function updateStats() {
    const total = Object.keys(participants).length;
    let normalCount = 0;
    let restCount = 0;
    
    Object.values(participants).forEach(p => {
        if (p.status === 'rest') {
            restCount++;
        } else {
            normalCount++;
        }
    });
    
    document.getElementById('totalCount').textContent = total;
    document.getElementById('normalCount').textContent = normalCount;
    document.getElementById('restCount').textContent = restCount;
}

// ìƒíƒœ ë³€ê²½
function updateStatus() {
    const id = document.getElementById("pSelect").value;
    const status = document.getElementById("statusSelect").value;
    const msgEl = document.getElementById("statusMsg");
    
    if (!id) {
        msgEl.className = 'alert';
        msgEl.style.display = 'block';
        msgEl.style.background = '#ffebee';
        msgEl.style.color = '#c62828';
        msgEl.style.border = '1px solid #ef9a9a';
        msgEl.textContent = 'ì°¸ê°€ìë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.';
        return;
    }
    
    const name = participants[id].name;
    const statusText = status === 'rest' ? 'íœ´ì‹' : 'ì •ìƒ';
    
    // Firebase ì—…ë°ì´íŠ¸
    if (db) {
        db.ref("participants/" + id).update({ status });
    } else {
        participants[id].status = status;
        renderAll();
    }
    
    // ì„±ê³µ ë©”ì‹œì§€
    msgEl.className = 'alert success';
    msgEl.innerHTML = `<strong>${id}. ${name}</strong>ë‹˜ì˜ ìƒíƒœê°€ <strong>'${statusText}'</strong>ìœ¼ë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.`;
    
    // 3ì´ˆ í›„ ë©”ì‹œì§€ ìˆ¨ê¸°ê¸°
    setTimeout(() => {
        msgEl.style.display = 'none';
    }, 3000);
}

// ì´ˆê¸°í™”
document.addEventListener('DOMContentLoaded', () => {
    setTimeout(initFirebase, 500);
});
</script>

</body>
</html>

